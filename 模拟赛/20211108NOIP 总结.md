# 20211108NOIP 总结

### 法咒 kedavra

看到样例这么简单的时候就知道这道题的答案十分简单，但是没有想到这是一个先手\后手必赢的游戏，也怪自己没有推结论。

这题有个很关键的就是：选择了$y$，那么$y$一定会出现。

结论：最大值有奇数个时必赢，偶数个时必输。

证明：

1. 当只有一个数（奇数个）时必赢
2. 当最大值只有一个（奇数）时：若次大值有奇数个则令$y$为次大值，那么下一步的状态最大值有偶数个（必输），则先手必赢；若有偶数个，则令$y=0$，消去最大值，下一步的状态必输
3. 当最大值有若干个时，每次操作一定会让最大值少一，根据2.可知有奇数个时必赢，偶数个时必输

这题是有一堆掩人耳目的东西的博弈。

### 颜色 color

做法真的简单，但是数据把线段树卡掉了，赛时懒得写ST表，然后就炸掉了，应该尽量优化复杂度。

### 启动w omega

没想到今晚能够改出来。

首先用平面玩一玩，发现性质：对于每一维一定是连续的，没有断层的，就是说对于每一维出现的值都在一个区间中。

现在把前$k-1$维看作一个整体

然后发现每次的操作有两种情况：

1. 一个新的前$k-1$维，然后贡献形如$(\sum_{i=1}^{k-1}|x_i-s_i|)*L+c(L)$，其中$c(L)$是关于$L$的常数
2. 在一个已有的前$k-1$维上，在第$k$维的区间前或后加上一个长度为$L$的区间（就是拓展），贡献形如$((\sum_{i=1}^{k-1}|x_i-s_i|)+|y_k-s_k|)*L+c(L)$，其中$c(L)$是关于$L$的常数

那么现在根据前$k-1$维和起始点的距离和从小到大、字典序从小到大生成尽量多但不超过$m$个前$k-1$维，然后1.用set维护，2.用线段树+set维护即可

### 丛林宝藏 treasure

这道题学到了二进制的平衡规划，这里稍稍总结一下：

二进制平衡规划适用于**对于转移有二进制下的要求**的DP，并且尽量要让对于二进制的要求可拆分、各部分独立，比如今天这个要求转移是子集\父集关系的DP。

一般操作方法为将二进制分为前半部分和后半部分，这样能够使得空间不变，指数减半，一般就能优化过了。

通常设的状态$F_{x,y}$表示**已确定的部分**用于比较的二进制状态的前半部分为$x$，**强制要求接下来选择**的二进制状态的后半部分为$y$。

这样要查询的时候后半部分确定，只需要枚举前半部分；要插入的时候前半部分确定，只需要枚举后半部分。

由于判断是可拆分、各部分独立的，所以只需要让查询\插入时枚举的部分合法即可。