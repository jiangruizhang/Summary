# 20211113NOIP 总结

### 赛文当斯减肥 weight

赛时没有找到很好的性质，但其实正解利用的性质很简单，就是每次交换颜色一定会改变。

所以先判断点权是否合法，然后进行二分图判断。

如果不是，那么存在奇环，假如有颜色不对的情况，到奇环里走一圈就好了。

如果是二分图，那么对于一个权有两个信息，即颜色和位置（左右部），令RB分别为01，左右分别为01，发行进行交换这两个权的异或值不变，于是对于每个权判断一下就好了。

### 卧龙先生决斗 battle

期望和概率的确不行。

设$f_{i,j,0/1}$表示最终状态下位置$i$是$2^j$的概率和期望分数，$g_{i,j,0/1}$表示用最多$i$个位置最后合并成$2^j$的期望和概率。

首先是$g$的转移。

对于概率无非就是直接放一个$2^j$或合并出$2^j$，所以$g_{i,j,0}=g_{i,j-1,0}g_{i-1,j-1,1}+[j<m]p_j$；对于期望，其形式为$\sum p·val$，同时还要考虑这一步是合并出来的分数，所以$g_{i,j,1}=g_{i,j-1,0}g_{i-1,j-1,1}+g_{i,j-1,1}g_{i-1,j-1,0}+g_{i,j-1,0}g_{i-1,j-1,0}2^j$。

接着是$f$的转移。

先考虑概率，分成三种情况：1.新加入一个和末尾的数相等的数让末尾上升2.生成一个比末尾小的数3.直接添加一个比末尾大的数。这里能够直接添加是因为添加比末尾小的数可能会导致合并，这些情况前两种可以计数。所以$f_{i,j,0}=f_{i,j-1,0}g_{n-i,j-1,0}+\sum_{k<j}f_{i-1,k,0}p_j+\sum_{k>j}f_{i-1,k,0}g_{n-i+1,j,0}$。

再考虑期望，其实思路也类似上面，如下：$f_{i,j,1}=f_{i,j-1,0}g_{n-i,j-1,1}+f_{i,j-1,1}g_{n-i,j-1,0}+f_{i,j-1,0}g_{n-i,j-1,0}2^j+\sum_{k<j}f_{i-1,k,1}p_j+\sum_{k>j}(f_{i-1,k,0}g_{n-i+1,j,1}+f_{i-1,k,1}g_{n-i+1,j,0})$。

### 克里姆森玩球 ball

对于$a_{i} \not = a_{i+1}$的情况，显然有$c_{a_{i+1}}=c_{i}$，于是可以搞出来一些链，然后考场上就没有思路了。

题解说假如已知有$t$种颜色，那么可以

………

### 划分 div

比较少见的构造题。

首先把$c_0$或$c_1$是0的情况处理掉，显然$c_{0}=0$那么全部填1就行了，$c_1=0$那么填两个极大值，但是又有较大差别即可，比如$10^4$和$10^3$，然后其他填1。

剩下按照$c_0$和$c_1$的奇偶性分类讨论即可。

1. $c_1$奇，$c_0$奇，那么有$n\ge4$。当$c_1\ge3$时可以$c_1$全1，$c_0$全2，证明考虑剩余数的和的奇偶性即可；当$c_1=1$，那么$c_1$填$10^4$，$c_0$一个2，剩余全1
2. $c_1$奇，$c_0$偶，那么$c_1$全1，$c_0$全2，证明类似
3. $c_1$偶，$c_0$偶，那么$c_1$全2，$c_0$全1，证明：显然有$c_0\ge 2$，那么当抽走一个2时，可以用两个1合成一个2，使得1和2的数量均为偶数；当抽走一个1时，显然和为奇数，不可能平分
4. $c_1$偶，$c_0$奇，比赛的时候没有想出来，这里是赛后的构造：当$c_0\ge 3$时，$c_1$全部为$x$，$c_0$有一个$x-3$，一个$1$，一个$2$，剩余全部为$y$，那么显然取走$x$可以平分，取走$x-3$剩余和为奇数，不能平分，（中间的思路忘了），然后令$x=3000$，$y=6000$即可；当$c_0=1$，按题解构造。